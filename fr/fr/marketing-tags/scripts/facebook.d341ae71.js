(function(){"use strict";if(/@|%40/.test(document.location.href))return!1;const i={...window.utag_data||{},get country(){return window.location.pathname.split("/")[1]},get language(){return window.location.pathname.split("/")[2]},get site_level_1(){return window.location.pathname.split("/")[3]},get site_level_2(){return window.location.pathname.split("/")[4]}};({_fbq:null,country:null,pixelType:null,cAPI:null,countrySettings:{at:["EUR","RIIG","script"],au:["AUD","RIIG","script"],be:["EUR","RIIG","script"],ca:["CAD","RIIG","script"],ch:["CHF","RIIG","script"],cz:["CZK","RIIG","script"],de:["EUR","RIIG","script"],dk:["DKK","RIIG","script"],es:["EUR","RIIG","script"],fi:["EUR","RIIG","script"],fr:["EUR","RIIG","script"],gb:["GBP","RIIG","script"],hr:["EUR","RIIG","script"],hu:["HUF","RIIG","script"],ie:["EUR","RIIG","script"],in:["INR","RIIG","script"],it:["EUR","RIIG","script"],jp:["JPY","RIIG","script"],kr:["KRW","RIIG","script"],nl:["EUR","RIIG","script"],no:["NOK","RIIG","script"],pl:["PLN","RIIG","script"],pt:["EUR","RIIG","script"],ro:["RON","RIIG","script"],rs:["RSD","RIIG","script"],ru:["RUB","RIIG","script"],se:["SEK","RIIG","script"],si:["EUR","RIIG","script"],sk:["EUR","RIIG","script"],ua:["UAH","RIIG","script"],us:["USD","RIIG","script"],ae:["AED","ROIG","script"],bh:["BHD","ROIG","script"],cl:["CLP","ROIG","script"],eg:["EGP","ROIG","script"],il:["ILS","ROIG","script"],jo:["JOD","ROIG","script"],kw:["KWD","ROIG","script"],ma:["MAD","ROIG","script"],mx:["MXN","ROIG","script"],my:["MYR","ROIG","script"],om:["OMR","ROIG","script"],ph:["PHP","ROIG","script"],qa:["QAR","ROIG","script"],sa:["SAR","ROIG","script"],sg:["SGD","ROIG","script"],th:["THB","ROIG","script"]},get marketType(){return this.countrySettings[this.country][1]},get currency(){return this.countrySettings[this.country][0]},get id(){return this.marketType==="RIIG"?"3465423686912116":"888079142586440"},standardEvents:["PageView","Search","AddToCart","AddToWishlist","ViewContent","InitiateCheckout","AddPaymentInfo","Purchase","CompleteRegistration","Contact","CustomizeProduct","Donate","FindLocation","Lead","Schedule","StartTrial","SubmitApplication","Subscribe"],getPixelType:function(e){return this.countrySettings[e||this.country][2]},trackType:function(e){return this.standardEvents.includes(e)?"trackSingle":"trackSingleCustom"},getEventId:function(){return this.cAPI?{eventID:`${new Date().getTime()}.${Math.floor(Math.random()*1e11)}`}:{}},init:function(e=i.country,r=this.getPixelType(e)){this.country=e,this.pixelType=r,this.cAPI=!!this.countrySettings[this.country]?.[3],this.pixelType==="script"?function(t,n,a,o,c,s,u){if(t.fbq)return this._fbq=t.fbq,this._fbq("init",this.id),this.initEventTracking();c=t.fbq=function(){c.callMethod?c.callMethod.apply(c,arguments):c.queue.push(arguments)},t._fbq||(t._fbq=c),c.push=c,c.loaded=!0,c.version="2.0",c.queue=[],s=n.createElement(a),s.async=!0,s.src=o,s.onload=function(){this._fbq=t.fbq,this._fbq("init",this.id),this.initEventTracking()}.bind(this),s.onerror=function(){this.pixelType="img",this.initEventTracking()}.bind(this),u=n.getElementsByTagName(a)[0],u.parentNode.insertBefore(s,u)}.bind(this)(window,document,"script","https://connect.facebook.net/en_US/fbevents.js"):this.initEventTracking()},send:function(e,r={}){const t=this.getEventId();if(i.country==="ch"&&(r.country=i.country,r.language=i.language),this.pixelType==="script"&&typeof this._fbq=="function")this._fbq(this.trackType(e),this.id,e,r,t);else{let n=`https://www.facebook.com/tr?id=${this.id}&ev=${e}&dl=${encodeURIComponent(window.location.origin+window.location.pathname)}&ts=${new Date().getTime()}`;t.eventID&&(n+=`&eid=${t.eventID}`),Object.entries(r).forEach(([a,o])=>{o&&(n+=`&cd[${a}]=${encodeURIComponent(typeof o=="string"?o:JSON.stringify(o))}`)}),new Image().src=n}},getTotalPrice:function(e=[]){return e.reduce((t,n)=>Number(t)+Number(n?.price||0)*Number(n?.quantity||0),0).toFixed(2)},getTotalQuantity:function(e=[]){return e.length?e.reduce((r,{quantity:t=1})=>Number(r)+Number(t),0):1},getContents:function(e=[]){let r=[];for(const t of e){let n={};t?.item_number_event&&(n.id=t.item_number_event),t?.id&&(n.id=t.id),t?.price&&(n.item_price=t.price),t?.quantity&&(n.quantity=t.quantity),t?.product_quantity&&(n.quantity=Number(t.product_quantity)),r.push(n)}return r},trackPageView:function(){this.send("PageView")},trackSearch:function(){this.trackEventCB("search_box",e=>{let{event_action:r,event_label:t}=e;if(r!=="hard_search")return;let n={currency:this.currency,search_string:t};return{eventName:"Search",payload:n}})},trackAddToWishlist:function(){this.trackEventCB("ecommerce",e=>{let{event_action:r,event_label:t,custom:n={},params:a={}}=e,{item_number_event:o,product_quantity:c}=n,{items:s=[]}=a;if(r!=="add_to_wishlist")return;let u=o?.split(",")||[],d=c?.split(",")||[],I=[];for(let p=0;p<u.length;p++){let h={};u[p]&&(h.item_number_event=u[p]),d[p]&&(h.product_quantity=d[p]),I.push(h)}let l={currency:this.currency,content_type:"product",value:s.length?this.getTotalPrice(s):void 0,content_name:s.length?s.map(p=>p.name).toString():void 0,contents:s.length?this.getContents(s):this.getContents(I)};return t==="pip"?(l.value=Number(i?.price?.[0]||i?.product_prices?.[0]),l.content_name=i?.product_names?.[0]||i?.product_item_names?.[0],l.content_category=`${i?.category_local?.toLowerCase()||""} - ${i?.category}`,l.contents[0].item_price=Number(i?.price?.[0]||i?.product_prices?.[0])):i?.page_category_level==="chapter"&&t==="plp"&&(l.content_category=`${i?.site_level_2}`),{eventName:"AddToWishlist",payload:l}})},trackAddToCart:function(){this.trackEventCB("add_to_cart",e=>{let{event_label:r,params:t={},custom:n={}}=e,{currency:a,items:o=[]}=t,c={currency:a||this.currency,content_type:"product",value:Number(n?.cart_value_local)||this.getTotalPrice(o),contents:this.getContents(o)};return r==="pip"?(c.content_category=`${i?.category_local.toLowerCase()||""} - ${i?.category}`,c.content_name=i?.product_item_names?.[0]||i?.product_names?.[0]):i?.page_category_level==="chapter"&&r==="plp"&&(c.content_category=`${i?.site_level_2}`),{eventName:"AddToCart",payload:c}})},trackPipView:function(){let e={currency:i?.currency_code||this.currency,content_type:"product",value:Number(i?.price?.[0]||i?.product_prices?.[0]),content_category:`${i?.category_local.toLowerCase()||""} - ${i?.category}`,content_name:i?.product_item_names?.[0]||i?.product_names?.[0],contents:[{id:i?.product_ids?.[0],quantity:1,item_price:Number(i?.price?.[0]||i?.product_prices?.[0])}]};this.send("ViewContent",e)},trackInitiateCheckout:function(){this.trackEventCB("begin_checkout",e=>{let{params:r={},custom:t={}}=e,{cart_value:n,cart_quantity:a}=t,{items:o=[]}=r,c={currency:this.currency,content_type:"product",value:n||this.getTotalPrice(o),num_items:a||this.getTotalQuantity(o),contents:this.getContents(o)};return{eventName:"InitiateCheckout",payload:c}})},trackPurchase:function(){this.trackEventCB("purchase",e=>{let{name:r,params:t={},custom:n={}}=e,{currency:a,value:o,items:c=[],transaction_id:s}=t,{cart_quantity:u}=n;if(r!=="purchase"&&!window.location.pathname.includes("/confirmation/"))return;let d={currency:a||this.currency,content_type:"product",value:o||this.getTotalPrice(c),num_items:u||this.getTotalQuantity(c),order_id:s,contents:this.getContents(c)};return{eventName:"Purchase",payload:d}})},trackEventCB:function(e,r){window.addEventListener(e,({detail:t={}})=>{let{eventName:n,payload:a={}}=r(t)||{};n&&this.send(n,a)})},trackLocal:function(){if(window._fbLocal)window._fbLocal(this,i);else{let e=()=>{window?._fbLocal?.(this,i),window.removeEventListener("_fbLocalLoaded",e)};window.addEventListener("_fbLocalLoaded",e)}},initEventTracking:function(){this.trackPageView(),this.trackSearch(),this.trackAddToWishlist(),this.trackAddToCart(),i?.page_type==="product information page"?this.trackPipView():window.Checkout&&this.trackPurchase(),this.trackLocal()}}).init()})();
